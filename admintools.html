    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>


<div class="admintools-container color-111111 text-white" style="display:block;             color: #ffffff;  /* This makes the text color white */ ; margin-top: 15px;  margin-bottom: 15px; border-radius: 30px">
<button class="button-s" id="aboutBtnEditor" onclick="toggleEditorMenu()" style="background-color: #35b7ff">Texteditor</button>

<!-- Popup Container -->


<!-- HEATMAPZ EDITOR ADMIN START -->





   
<div id="category-menu">
    <h2>Recolor Categories</h2>
    <select id="category-select">
        <!-- Category options will be dynamically generated -->
    </select>
    <input type="color" id="color-picker">
    <button type="button" id="update-color">Update Color</button>
</div>

<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<script>
$(document).ready(function() {
    // Fetch categories and populate dropdown
    fetch('/get-categories').then(response => response.json()).then(data => {
        data.forEach(category => {
            // Append the category to the select dropdown
            $('#category-select').append(new Option(category.text, category.color));
        });

        // Set the initial value of the HEX editor to the first category's color
        $('#color-picker').val($('#category-select').val());
    });

    // Update the HEX editor when the selected category changes
    $('#category-select').change(function() {
        // Set the HEX editor to the currently selected category's color
        $('#color-picker').val($(this).val());
    });

    // Handle the color update
    $('#update-color').click(function() {
    var oldColor = $('#category-select').val();
    var newColor = $('#color-picker').val();
    console.log(`Updating color from ${oldColor} to ${newColor}`);

    // Update the category color
    $.ajax({
        url: '/update-category',
        method: 'POST',
        contentType: 'application/json',
        data: JSON.stringify({ oldColor: oldColor, newColor: newColor }),
        success: function(response) {
            console.log('Category color updated successfully:', response);
            
            // Now update the shapes in the database with the new color
            $.ajax({
                url: '/update-shape-colors',
                method: 'POST',
                contentType: 'application/json',
                data: JSON.stringify({ oldColor: oldColor, newColor: newColor }),
                success: function(response) {
                    console.log('Shapes color updated successfully:', response);
                    // Optionally refresh the map or shapes to reflect the color change
                },
                error: function(xhr, status, error) {
                    console.error('Error updating shapes color:', error);
                }
            });
        },
        error: function(xhr, status, error) {
            console.error('Error updating category color:', error);
        }
    });
});

});

</script>

<!-- Category Renaming Section -->
<div>
    <h2>Rename Category</h2>
    <select id="rename-category-select"></select>
    <input type="text" id="rename-category-name" placeholder="Enter new category name" />
    <button id="rename-category">Rename Category</button>
</div>

<script>
$(document).ready(function() {
    // Fetch categories and populate the rename dropdown
    fetch('/get-categories').then(response => response.json()).then(data => {
        data.forEach(category => {
            $('#rename-category-select').append(new Option(category.text, category.color));
            // Populate the hex editor with the current color
            $('#color-picker').val(category.color);
        });
    });

    // Handle the category rename
    $('#rename-category').click(function() {
        var color = $('#rename-category-select').val();
        var newName = $('#rename-category-name').val().trim();
        if (newName === "") {
            console.error('New category name is required');
            return;
        }
        console.log(`Renaming category ${color} to ${newName}`);
        
        $.ajax({
            url: '/rename-category',
            method: 'POST',
            contentType: 'application/json',
            data: JSON.stringify({ color: color, newName: newName }),
            success: function(response) {
                console.log('Category renamed successfully:', response);
                // Optionally refresh the categories in the dropdown and other related UI
            },
            error: function(xhr, status, error) {
                console.error('Error renaming category:', error);
            }
        });
    });
});
</script>

<!-- Category Creation Section -->
<div>
    <h2>Create New Category</h2>
    <input type="text" id="create-category-name" placeholder="Enter new category name" />
    <input type="color" id="create-category-color" />
    <button id="create-category">Create Category</button>
</div>
<script>
$(document).ready(function() {
    // Handle the category creation
    $('#create-category').click(function() {
        setTimeout(() => { // Adding a delay to ensure the input value is updated
            var name = $('#create-category-name').val().trim();
            var color = $('#create-category-color').val();
            console.log(`Inputted name: '${name}'`); // Log the inputted name for debugging
            console.log(`Selected color: '${color}'`); // Log the selected color for debugging
            
            if (name === "") {
                console.error('Category name is required');
                return;
            }
            console.log(`Creating new category '${name}' with color '${color}'`);
            
            $.ajax({
                url: '/create-category',
                method: 'POST',
                contentType: 'application/json',
                data: JSON.stringify({ name: name, color: color }),
                success: function(response) {
                    console.log('Category created successfully:', response);
                    // Optionally refresh the categories in the UI
                },
                error: function(xhr, status, error) {
                    console.error('Error creating category:', error);
                }
            });
        }, 100); // Delay of 100 milliseconds
    });
});
</script>

<!-- Category Deletion Section -->
<div>
    <h2>Delete Category</h2>
    <select id="delete-category-select">
        <!-- Options will be dynamically populated -->
    </select>
    <button id="delete-category">Delete Category</button>
</div>

<script>
$(document).ready(function() {
    // Populate the delete category dropdown
    fetchCategories();

    // Handle the category deletion
    $('#delete-category').click(function() {
        var color = $('#delete-category-select').val();
        console.log(`Deleting category with color ${color}`);

        $.ajax({
            url: '/delete-category',
            method: 'POST',
            contentType: 'application/json',
            data: JSON.stringify({ color: color }),
            success: function(response) {
                console.log('Category deleted successfully:', response);
                // Refresh the categories in the dropdowns
                fetchCategories();
            },
            error: function(xhr, status, error) {
                console.error('Error deleting category:', error);
            }
        });
    });
});

function fetchCategories() {
    fetch('/get-categories').then(response => response.json()).then(data => {
        var categorySelect = $('#delete-category-select');
        categorySelect.empty(); // Clear existing options
        data.forEach(category => {
            categorySelect.append(new Option(category.text, category.color));
        });
    });
}
</script>

<script>
    function toggleCategory2Menu() {
        var category2Menu = document.getElementById('category2-menu');
        if (category2Menu.style.display === 'none') {
            category2Menu.style.display = 'block';
        } else {
            category2Menu.style.display = 'none';
        }
    }
</script>


<button onclick="window.location.href='/export-geojson'">Export GeoJSON</button>
    
    <!-- Add a form for importing GeoJSON -->
    <form action="/import-geojson" method="POST" enctype="multipart/form-data">
        <input type="file" name="file" accept=".geojson">
        <button type="submit">Import GeoJSON</button>
    </form>

<!-- ADMINTOOLS CATEGORY LOADING END-->

<!-- Delete Objects by Category -->
<h2>Delete Objects by Category</h2>

<button id="delete-category-objects">Delete Only objects of the category</button>

<!-- Delete Objects by Object Type -->
<h2>Delete Objects by Object Type</h2>
<select id="delete-object-type-select">
    <option value="circle">Circle</option>
    <option value="rectangle">Rectangle</option>
    <option value="polygon">Polygon</option>
    <option value="polyline">Polyline</option>
    <option value="circlemarker">Circle Marker</option>
    <option value="marker">Marker</option>
    <!-- Add more object types as needed -->
</select>
<button id="delete-object-type-objects">Delete Objects</button>


<script>
$(document).ready(function() {
    // Populate the delete category dropdown
    fetchCategories();

    // Handle the category deletion
    $('#delete-category-objects').click(function() {
        var color = $('#delete-category-select').val();
        console.log(`Deleting objects with category color ${color}`);

        $.ajax({
            url: '/delete-objects-by-category',
            method: 'POST',
            contentType: 'application/json',
            data: JSON.stringify({ color: color }),
            success: function(response) {
                console.log('Objects deleted successfully:', response);
                // Refresh the categories in the dropdowns
                fetchCategories();
            },
            error: function(xhr, status, error) {
                console.error('Error deleting objects by category:', error);
            }
        });
    });

    // Handle the object type deletion
    $('#delete-object-type-objects').click(function() {
        var objectType = $('#delete-object-type-select').val();
        console.log(`Deleting objects of type ${objectType}`);

        $.ajax({
            url: '/delete-objects-by-object-type',
            method: 'POST',
            contentType: 'application/json',
            data: JSON.stringify({ objectType: objectType }),
            success: function(response) {
                console.log('Objects deleted successfully:', response);
                // Optionally refresh the map or shapes to reflect the deletion
            },
            error: function(xhr, status, error) {
                console.error('Error deleting objects by object type:', error);
            }
        });
    });

    // Other JavaScript code here...
});
</script>
